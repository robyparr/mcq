<div data-controller="bulk-actions" class="row -m-8 h-screen">
  <div class="column md4 mt-8 pr-4">
    <%# Heading %>
    <div class="heading">
      <% if current_queue %>
        <h2 class="page-header pl-2" style="border-left: 3px solid <%= current_queue.color %>">
          <%= current_queue.name %>
        </h2>
      <% else %>
        <h2 class="page-header">Media</h2>
      <% end %>
    </div>

    <%# Top-level actions %>
    <%= link_to 'Add Media', new_media_item_path(queue: current_queue), class: 'primary button' %>

    <% if current_user.pocket_integration.present? %>
      <%= link_to 'Synchronize Pocket',
                  synchronize_integrations_path(integration_id: current_user.pocket_integration.id),
                  class: 'button',
                  method: :post %>
    <% end %>

    <% if current_queue %>
      <span data-controller="tooltip" data-tooltip-align="right">
        <button type="button" class="button icon-only" data-action="tooltip#show" data-testid="page-overflow-btn">
          <i class="bi bi-three-dots-vertical icon"></i>
        </button>
        <template data-target="tooltip.template">
          <ul class="menu">
            <li><%= link_to 'Edit Queue', edit_queue_path(current_queue), class: 'menu-item' %></li>
            <li>
              <%= link_to 'Delete Queue',
                          queue_path(current_queue),
                          class: 'menu-item',
                          method: :delete,
                          data: { confirm: 'Are you sure?' } %>
            </li>
          </ul>
        </template>
      </span>
    <% end %>

    <%# Bulk actions & filters %>
    <div class="toolbar my-4">
      <%= render 'bulk_actions', queues: current_user_queues %>
    </div>
    <%= render 'filters', search_path: media_items_path, priorities: @presenter.filter_priorities %>

    <% if @presenter.media_items.present? %>
      <%= render 'media_items', presenter: @presenter %>
    <% else %>
      <%= @presenter.no_media_items_message %>
    <% end %>
  </div>

  <div class="column md8 border-l pt-8 pl-4">
    <%= turbo_frame_tag 'media-item-pane' do %>
      <% if @media_item %>
        <%= render 'media_items/media_item', media_item: @media_item %>
      <% else %>
        <div class="flex justify-center items-center h-full">
          <span class="text-lg text-muted">Select a media item</span>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
